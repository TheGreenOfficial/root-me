## Challenge name: File upload - Double extensions


<img width="1457" height="509" alt="image" src="https://github.com/user-attachments/assets/0738bf23-033c-4cc6-8087-17b6dc873f6e" />
<br>
<br>

``` Challenge Link:``` [https://www.root-me.org/en/Challenges/Web-Server/File-upload-Double-extensions](https://www.root-me.org/en/Challenges/Web-Server/File-upload-Double-extensions)
<br>
<br>

**After starting the challenge we can see a photo galery v2 as we solved v1 previously and we can upload images in gallery. So, let us get started.**

<br>
<img width="1458" height="354" alt="image" src="https://github.com/user-attachments/assets/bd0a4465-3c3e-4c68-8f1c-a30abdbaa393" />
<br>
<br>

**We will open brupsuite to analyze request while we upload files and try to bypass the file upload logic and insted of image we will upload .php file to run arbitrary commands on server.**

<br>
<img width="1998" height="1177" alt="image" src="https://github.com/user-attachments/assets/144b4d4c-3d23-4f46-a882-3c74d2eff249" />
<br>
<br>

**Up there in the picture we can see how normal request of uploading image so now we will change/modify the request and upload a .php file type..**
<br>
<br>
**From the original request we will change the file name form this** ``` filename="image.jpg" ``` **to this** ``` filename="image.php.jpg" ``` **here you may thing if .jpg is there how our .php will run but as the challange says double externsion it checks and removes the last one not actually does but its imaginary and whatever the first extension is it thinks/executes it as that.** 
<br><br>
**Also we will put this php code somewhere inside the image data..**

``` 
 <?php
 system($_GET["cmd"]);
 ?>
```

<br>

**Now our modyfied request looks like this:**


<img width="1542" height="924" alt="image" src="https://github.com/user-attachments/assets/6ee4f731-a5ce-4308-8c6b-ed90a2b87601" />
<br>
<br>

**After forwarding the request we can see success message. Now let's see the uploaded file form the given location..**

<br>
<img width="1542" height="396" alt="image" src="https://github.com/user-attachments/assets/cc5d5bbf-4e8d-4e19-a4b2-bd332aad6763" />
<br>
<br>

**We can see .passwd in users home folder after doing ls in it. So, we will do cat to view its contents to get our flag.**

<br>
<img width="1561" height="326" alt="image" src="https://github.com/user-attachments/assets/4d4ffdab-7f2e-4756-91aa-f593d22fdd8d" />
<br>
<br>

**We got our flag/passwd as "Gg9LRz-hWSxqqUKd77-_q-6G8" we can use this to solve the challenge.**

**Thankyou.**
