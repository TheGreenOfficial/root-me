## Challenge name: XPath injection - Authentication


<img width="1334" height="430" alt="image" src="https://github.com/user-attachments/assets/40bfa42c-abe7-4638-b210-84b96fcdd6f9" />
<br>
<br>

``` Challenge Link:``` [https://www.root-me.org/en/Challenges/Web-Server/XPath-injection-Authentication](https://www.root-me.org/en/Challenges/Web-Server/XPath-injection-Authentication)
<br>
<br>

**After starting the challenge you can see that there are members list and login field where John is admin and our mission is to retrieve the administrator password.**

<br>
<img width="1328" height="416" alt="image" src="https://github.com/user-attachments/assets/81a7ec9b-b563-4fbd-ba3c-447b227aa624" />
<br><br>
<img width="1328" height="416" alt="image" src="https://github.com/user-attachments/assets/25b5e1e6-333b-413f-b92f-64a05744fe18" />
<br>
<br>

**Most of the peoples here I assume that they doesn't have much knowledge on it like sql and other injection attacks so I will try to explan x - path syntax first.**
<br><br>
**What is x path? So, x path is a query language used with backend programming language like java, php, py and supported in almost all of the languages.**
<br><br>
**Here's how the table shown in challenge looks like in .xml file:**

```
<users>
    <user>
        <name>Steve</name>
        <email>steve@jobs.com</email>
        <account>subscriber</account>
        <password>stevepass</password>
    </user>
    <user>
        <name>John</name>
        <email>john@doe.org</email>
        <account>administrator</account>
        <password>johnpass</password>
    </user>
    <user>
        <name>Eric</name>
        <email>ric@ard.biz</email>
        <account>subscriber</account>
        <password>ericpass</password>
    </user>
</users>
```

**X path syntax to use in programming language: **

```
//        <- it is used to search anywhere in the xml document.

//user    <- returns all users

/         <- detect child relationship

//user/name     <- returns all <name> elements under <user>

//user/name/text() <- text() extracts the text so output will be: Steve, John, Eric

position()  <- XPath doesn’t have LIMIT, but it has node positions.

eg:
position()	user
1	          Steve
2	          John
3	          Eric

//user[position()=1]/name   <- Node positions are 1-indexed, not 0-indexed.So, it selects 1 which is steve.

//user[position()=2]/account/text()  <- it will return administrator.

we can assume x path query in programing language looks like this according to that login check:

string(
  //user[
    name/text()='USERNAME'
    and
    password/text()='PASSWORD'
  ]/account/text()
)

If credentials are valid → returns subscriber or administrator or anything that developer has coaded..
and in programming language it is checked something like this:

if(result != "" && return == administrator)  // same goes for  subscriber check..
    login success as admin
else: failed..

```

**So, we can't inject somethin and retrive whole db or somein like in sql select which prints everything rawly to empty space in web according to that now we can craft our payload to be** ``` password/text()='admin' or position()='2' ``` **and after login it prints the password of that user john as it is a ctf..**
<br><br>
**Meaning:**

**if the current <user> node is 2nd, predicate is TRUE**

**user #2 is John (admin)**

**Result:
-> login as John
-> post‑login page prints John’s data
-> password appears**

<br>
<img width="1524" height="869" alt="image" src="https://github.com/user-attachments/assets/27f83d3c-984b-48e4-b824-79c7c8614968" />
<br>
<br>

**There is another method also as** ``` username=John']%00&password= ```
<br>
**%00 → \x00 In C-based string handling (libxml, old PHP bindings) String parsing stops at NULL So, everyhting after %00 is ignored and query beocmces** ``` string(//user[name/text()='John']) ```**predicate valid, password check never evaluated, query returns the John node.**

<br>
<img width="1524" height="869" alt="image" src="https://github.com/user-attachments/assets/c8ab2874-d4db-4387-85f1-71e2bb0ce4ba" />
<br>
<br>

**That was the challenge you can use this "6FkC67ui8njEepIK5Gr2Kwe" as flag/passwd to validate.**
<br>
**Thankyou.**
