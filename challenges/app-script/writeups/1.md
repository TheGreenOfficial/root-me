## Challenge name: Bash - System 1


<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/85443ad8-45af-4127-b554-0fa7956b8341" />
<br>
<br>

``` Challenge Link:``` [https://www.root-me.org/en/Challenges/App-Script/ELF32-System-1](https://www.root-me.org/en/Challenges/App-Script/ELF32-System-1?lang=en)
<br>
<br>

**Statement:** <br>
*Source code*
```
    #include <stdlib.h>
    #include <sys/types.h>
    #include <unistd.h>
     
    int main(void)
    {
        setreuid(geteuid(), geteuid());
        system("ls /challenge/app-script/ch11/.passwd");
        return 0;
    }

```

<br>
Challenge connection informations:

```
Host	challenge02.root-me.org
Protocol	SSH
Port	2222
SSH access 	ssh -p 2222 app-script-ch11@challenge02.root-me.org 
Username	app-script-ch11
Password	app-script-ch11
```

<br>

**After connecting to challenge using ssh we can see that there is .passwd file where our file is and binary ch11 have access to it.**

<br>
<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/ced9e728-33b2-4d7f-8816-f86138acd468" />
<br>
<br>

**The code of that binary is provided and in that c code we can see that its using system() command and system funciton uses $PATH variable whih is /bin/**

<br>
<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/811632f1-a2dd-42c3-8c5d-fc06cc983360" />
<br>
<br>

**So now if we change our path to /tmp and we make ls named binary or a bash executable without sh format and put cat inside that to read .passwd file it will solve the challenge so lets begin.**

<br>
<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/3949ac08-c08b-4e72-a20f-568e80368574" />
<br>
<br>


**The challange makers were clever they blocked tmp so we can't use but ther is a folder called shm in dev which stores things in memory and will be vanished after a restart. Let's use that and make a file/executable named ls and put or payload in it:**
<br><br>
```
#!/bin/sh  
cat /challenge/app-script/ch11/.passwd
```

<br>
<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/fcd47c0d-b7ee-46d5-affa-c910bfd8c564" />
<br>
<br>

**Our payload/new executable as replacement of ls is ready now lets change the $PATH using this command:** <br><br>
```
export PATH=/dev/shm:$PATH
```

<br>

**After that cd to users home ~ dir and run the binary using ./ch11 or bash ch11 whatever you prefer and ls will now work cuz our custom one is there right now and that will run don't get confused and cd works because its not a binary in /bin/ its inbuilt into shell baybe for faster execution I guess..**

<br>
<img width="1333" height="328" alt="image" src="https://github.com/user-attachments/assets/48d6a688-b2ca-47d8-baa2-f837200f30ab" />
<br>
<br>

**As you can see it printed the .passwd content. So, we can use this "!oPe96a/.s8d5" as flag/passwd to validate the challenge..** <br>
**Thankyou.**


